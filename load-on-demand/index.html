<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        ol,
        li {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        #ct {
            width: 420px;
            margin: 0 auto;
        }

        ol {
            font-size: 0;
            width: 440px;
            margin-left: -20px;
        }

        li {
            margin-top: 40px;
            display: inline-block;
            width: 200px;
            height: 150px;
            background-color: pink;
            margin-left: 20px;
        }

        a {
            display: block;
            background-color: #fff;
        }

        img {
            width: 100%;
        }
    </style>
</head>

<body>
    <div id="ct">
        <ol class="dribbbles group">
            <li id="screenshot-3877399" class="group ">
                <a class="dribbble-link" href="/shots/3877399-Porsche-911">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/7105164.jpg">
                </a>
            </li>
            <li id="screenshot-3877134" class="group ">
                <a class="dribbble-link" href="/shots/3877134-Grow">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/75074412.jpg">
                </a>
            </li>
            <li id="screenshot-3878516" class="group ">
                <a class="dribbble-link" href="/shots/3878516-Gardening">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/45407588.jpg">
                </a>
            </li>
            <li id="screenshot-3878237" class="group">
                <a class="dribbble-link" href="/shots/3878237-Drift-Features">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/6641333.jpg">
                </a>
            </li>
            <li id="screenshot-3877583" class="group team">
                <a class="dribbble-link" href="/shots/3877583-Nashville-Sticker">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/58925764.jpg">
                </a>
            </li>
            <li id="screenshot-3877006" class="group ">
                <a class="dribbble-link" href="/shots/3877006-Deerly-Co">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/79874952.jpg">
                </a>
            </li>
            <li id="screenshot-3876279" class="group team">
                <a class="dribbble-link" href="/shots/3876279-Qieman2">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/7105164.jpg">
                </a>
            </li>
            <li id="screenshot-3878130" class="group team">
                <a class="dribbble-link" href="/shots/3878130-Marketing-Segmentation-Facebook-ad">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/75074412.jpg">
                </a>
            </li>
            <li id="screenshot-3877052" class="group ">
                <a class="dribbble-link" href="/shots/3877052-Children-s-Creativity">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/45407588.jpg">
                </a>
            </li>
            <li id="screenshot-3876798" class="group ">
                <a class="dribbble-link" href="/shots/3876798-Interior-inspiration">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/6641333.jpg">
                </a>
            </li>
            <li id="screenshot-3874990" class="group ">
                <a class="dribbble-link" href="/shots/3874990-Gradient-Illos-1">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/58925764.jpg">
                </a>
            </li>
            <li id="screenshot-3876772" class="group team">
                <a class="dribbble-link" href="/shots/3876772-Discover-Influencers">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/79874952.jpg">
                </a>
            </li>
            <li id="screenshot-3876711" class="group ">
                <a class="dribbble-link" href="/shots/3876711--Thank-you-Xi-xi">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/7105164.jpg">
                </a>
            </li>
            <li id="screenshot-3876591" class="group ">
                <a class="dribbble-link" href="/shots/3876591-Hello-Dribbble">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/75074412.jpg">
                </a>
            </li>
            <li id="screenshot-3877484" class="group ">
                <a class="dribbble-link" href="/shots/3877484-Icon-Set">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/45407588.jpg">
                </a>
            </li>
            <li id="screenshot-3876896" class="group ">
                <a class="dribbble-link" href="/shots/3876896-Lips">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/6641333.jpg">
                </a>
            </li>
            <li id="screenshot-3872898" class="group ">
                <a class="dribbble-link" href="/shots/3872898-Ignitics-Landing-Page-Illustration">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/58925764.jpg">
                </a>
            </li>
            <li id="screenshot-3876577" class="group ">
                <a class="dribbble-link" href="/shots/3876577-p-arrow-logo-design">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/79874952.jpg">
                </a>
            </li>
            <li id="screenshot-3876566" class="group ">
                <a class="dribbble-link" href="/shots/3876566-Characters">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/7105164.jpg">
                </a>
            </li>
            <li id="screenshot-3877713" class="group ">
                <a class="dribbble-link" href="/shots/3877713-Agency-Work-Page">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/75074412.jpg">
                </a>
            </li>
            <li id="screenshot-3876943" class="group ">
                <a class="dribbble-link" href="/shots/3876943-Child-fun">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/45407588.jpg">
                </a>
            </li>
            <li id="screenshot-3875480" class="group ">
                <a class="dribbble-link" href="/shots/3875480-Homepage">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/6641333.jpg">
                </a>
            </li>
            <li id="screenshot-3876588" class="group ">
                <a class="dribbble-link" href="/shots/3876588-Car-Sharing-Service">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/58925764.jpg">
                </a>
            </li>
            <li id="screenshot-3876323" class="group ">
                <a class="dribbble-link" href="/shots/3876323-Hello-Dribbble">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/79874952.jpg">
                </a>
            </li>
            <li id="screenshot-3876376" class="group ">
                <a class="dribbble-link" href="/shots/3876376-This-game-is-fun">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/7105164.jpg">
                </a>
            </li>
            <li id="screenshot-3876253" class="group ">
                <a class="dribbble-link" href="/shots/3876253-Rocket">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/75074412.jpg">
                </a>
            </li>
            <li id="screenshot-3877771" class="group ">
                <a class="dribbble-link" href="/shots/3877771-Slow-Animals-print">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/45407588.jpg">
                </a>
            </li>
            <li id="screenshot-3875878" class="group ">
                <a class="dribbble-link" href="/shots/3875878-ToDo-list-app-lists-and-remove-task-screen">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/6641333.jpg">
                </a>
            </li>
            <li id="screenshot-3877252" class="group ">
                <a class="dribbble-link" href="/shots/3877252-Wayfinding-Icons-Streamline-3-0">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/58925764.jpg">
                </a>
            </li>
            <li id="screenshot-3876192" class="group ">
                <a class="dribbble-link" href="/shots/3876192-Eerie-Eats">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/79874952.jpg">
                </a>
            </li>
            <li id="screenshot-3876738" class="group ">
                <a class="dribbble-link" href="/shots/3876738-Hello-dribbble">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/7105164.jpg">
                </a>
            </li>
            <li id="screenshot-3876714" class="group ">
                <a class="dribbble-link" href="/shots/3876714-The-little-white-dragon-illustrations">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/75074412.jpg">
                </a>
            </li>
            <li id="screenshot-3877912" class="group ">
                <a class="dribbble-link" href="/shots/3877912-Let-the-sugar-flow">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/45407588.jpg">
                </a>
            </li>
            <li id="screenshot-3877683" class="group ">
                <a class="dribbble-link" href="/shots/3877683-Back-to-Bits-Final-Fantasy-6">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/6641333.jpg">
                </a>
            </li>
            <li id="screenshot-3792888" class="group ">
                <a class="dribbble-link" href="/shots/3792888-Window-Detail">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/58925764.jpg">
                </a>
            </li>
            <li id="screenshot-3876806" class="group ">
                <a class="dribbble-link" href="/shots/3876806-liquefied-Planets">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/79874952.jpg">
                </a>
            </li>
            <li id="screenshot-3876575" class="group team">
                <a class="dribbble-link" href="/shots/3876575-Summertime-vibes">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/7105164.jpg">
                </a>
            </li>
            <li id="screenshot-3876531" class="group ">
                <a class="dribbble-link" href="/shots/3876531-Dribbble-Beginning">
                    <img alt="" src="" data-src="http://olch1yuye.bkt.clouddn.com/17-10-19/75074412.jpg">
                </a>
            </li>
        </ol>
        <p id="hello">hello/</p>
    </div>
    <script>
        var Lazy = (function () {
            //曝光加载组件封装思路
            //曝光加载的种类很多如图片的懒加载；上拉下拉加载（都是通过判断一个元素是否出现在页面然后做出相应的动作）
            //如何把这个功能抽象出来做成组件适用于各种类型（这个曝光加载首先可以抽象出‘曝光’所有的动作第一步都是判断是否曝光）
            //所以下面定义了一个$target（用来判断是否曝光的元素）和callback（曝光之后执行的函数）
            function Exposure($target, callback) {
                this.$target = $target
                this.callback = callback
                this.clock = null
                this.bind()
                this.check()
            }
            // Exposure.prototype.init = function () {
            // }
            Exposure.prototype.bind = function () {
                $(window).on('scroll', () => {
                    console.log('滚动')
                    if (this.clock) {
                        clearTimeout(this.clock)
                    }
                    this.clock = setTimeout(() => {
                        this.check()
                        console.log('滚完')
                    }, 300);
                });
            }
            Exposure.prototype.check = function () {
                if (this.isShow(this.$target)) {
                    this.callback(this.$target)
                }
            }
            Exposure.prototype.isShow = function () {
                this.windowHeight = $(window).innerHeight();
                this.scrollTop = $(window).scrollTop();
                this.offsetTop = this.$target.offset().top
                if (this.offsetTop < this.windowHeight + this.scrollTop && this.offsetTop > this.scrollTop) {
                    return true
                } else {
                    return false
                }
            };
            return {
                init: function ($targets, callback) {
                    $targets.each(function (index, target) {
                        new Exposure($(target), callback)
                    })
                }
            }
        })()

        //上面就是抽象出来的判断曝光组件；封装成laze
        //然后下面根据对应应用场景写callback
        function isLoaded($img) {
            var src = $img.attr('src')
            if (src) {
                return true
            };
            return false
        };
        function showImg($img) {
            var imgLink = $img.data('src')
            // console.log(imgLink)
            setTimeout(function () {
                $img.attr('src', imgLink)
            }, 500);
        };


        //然后下面是根据不同的$targets和callback调用；
        Lazy.init($('.group img'), function ($node) {
            if (!isLoaded($node)) {
                console.log('进来了')
                showImg($node)
            }
        })
        Lazy.init($('#hello'), function ($node) {
            $node.text($node.text() + $node.text())
        })
    </script>
</body>
</html>